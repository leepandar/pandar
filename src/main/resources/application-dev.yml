############## spring配置 ##############
spring:
  datasource:
    dynamic:
      primary: master
      strict: false
      datasource:
        master:
          type: com.zaxxer.hikari.HikariDataSource
          driver-class-name: com.mysql.cj.jdbc.Driver
          username: root
          password: root
          url: jdbc:mysql://localhost:3306/pandar?useUnicode=true&characterEncoding=UTF-8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true&useAffectedRows=true&rewriteBatchedStatements=true
      hikari:
        # 最小空闲连接数量
        minimum-idle: 20
        # 连接池最大连接数，默认是10
        maximum-pool-size: 100
        # 空闲连接存活最大时间，默认600000
        idle-timeout: 30000
        # 此属性控制池中连接的最长生命周期，值0表示无限生命周期，默认1800000即30分钟
        max-lifetime: 60000
        # 数据库连接超时时间,默认30秒，即30000
        connection-timeout: 30000
        # 测试连接
        connection-test-query: "SELECT 1"
  servlet:
    multipart:
      # 单个文件大小
      max-file-size: 100MB
      # 总文件大小
      max-request-size: 256MB
  data:
    # redis配置
    redis:
      # Redis数据库索引（默认为0）
      database: 3
      # Redis服务器地址
      host: 127.0.0.1
      # Redis服务器连接端口
      port: 6379
      # Redis服务器连接密码（默认为空）
      password:
      # 读取超时时间
      timeout: 10s
      # 连接超时时间
      connect-timeout: 5s
      lettuce:
        pool:
          enabled: true
          # 连接池最大连接数
          max-active: 200
          # 连接池最大阻塞等待时间（使用负值表示没有限制）
          max-wait: -1ms
          # 连接池中的最大空闲连接
          max-idle: 10
          # 连接池中的最小空闲连接
          min-idle: 0
  # 文件存储配置
  file-storage:
    # 默认使用的存储平台
    default-platform: "local-1"
    local: # 本地存储（不推荐使用），不使用的情况下可以不写
      - platform: local-1 # 存储平台标识
        enable-storage: true  #启用存储
        enable-access: true #启用访问（线上请使用 Nginx 配置，效率更高）
        domain: http://localhost:${server.port}${server.servlet.context-path}/files/ # 访问域名，例如：“http://127.0.0.1:8030/test/file/”，注意后面要和 path-patterns 保持一致，“/”结尾，本地存储建议使用相对路径，方便后期更换域名
        base-path: ${user.dir}/files/ # 文件存储路径：${user.dir}/files中间不能写 + 拼接，会被当成字符串
        path-patterns: "/**" # 访问路径，开启 enable-access 后，通过此路径可以访问到上传的文件

############## redisson配置 ##############
redisson:
  address: redis://${spring.data.redis.host}:${spring.data.redis.port}
  password: ${spring.data.redis.password}
  database: 3
  pingInterval: 10000
  connectionPoolSize: 100
  connectionMinimumIdleSize: 0

############## 日志配置 ##############
logging:
  level:
    com.pandar: debug
    org.springframework: warn
  config: classpath:logback.xml

##############  Actuator 配置：暴露监控端点 ##############
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,env,beans # 暴露需要的端点（* 表示暴露所有）
  endpoint:
    health:
      show-details: always # 显示健康检查详情